<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุธุงู ุงููุตูู ุงูุฐููุฉ ุงููุชูุงูู | Shagsu ERP</title>
    <link rel="icon" href="images/logo.png" type="image/png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="loader">
        <div class="spinner"></div>
        <p>ุฌุงุฑู ุชุญููู ุงููุธุงู ุงููุฏุฑุณู...</p>
    </div>

    <section id="auth-view">
        <div class="login-container">
            <div class="login-header">
                <img src="images/logo.png" alt="ุดุนุงุฑ" class="logo-lg">
                <h1>ูุธุงู ุงูุฅุฏุงุฑุฉ ุงููุฏุฑุณูุฉ</h1>
                <p>ุจูุงุจุฉ ุงูุฏุฎูู ุงูููุญุฏุฉ (ุฅุฏุงุฑู - ุทุงูุจ)</p>
            </div>
            
            <div class="login-box">
                <div class="user-type-selector">
                    <label>
                        <input type="radio" name="role" value="admin" checked onclick="setRole('admin')">
                        <span class="type-box"><i class="fas fa-user-tie"></i> ูุฏูุฑ / ูุนูู</span>
                    </label>
                    <label>
                        <input type="radio" name="role" value="student" onclick="setRole('student')">
                        <span class="type-box"><i class="fas fa-user-graduate"></i> ุทุงูุจ</span>
                    </label>
                </div>

                <form id="login-form">
                    <div class="input-group">
                        <i class="fas fa-envelope"></i>
                        <input type="email" id="email" placeholder="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู" required>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-lock"></i>
                        <input type="password" id="password" placeholder="ูููุฉ ุงููุฑูุฑ" required>
                    </div>
                    <div id="auth-msg" class="alert"></div>
                    <button type="submit" class="btn-login">ุชุณุฌูู ุงูุฏุฎูู <i class="fas fa-arrow-left"></i></button>
                </form>
                <div class="login-footer">
                    <span onclick="toggleSignup()" id="signup-link">ุชุณุฌูู ุญุณุงุจ ุฌุฏูุฏ</span>
                </div>
            </div>
        </div>
    </section>

    <section id="main-app" style="display: none;">
        
        <aside class="sidebar">
            <div class="sidebar-header">
                <img src="images/logo.png" alt="Logo">
                <h3>ุงููุตูู ุงูุฐููุฉ</h3>
            </div>
            
            <ul class="menu-links">
                <li onclick="navigate('dashboard')" class="active"><i class="fas fa-home"></i> <span>ุงูุฑุฆูุณูุฉ</span></li>
                
                <li class="admin-only" onclick="navigate('students')"><i class="fas fa-users"></i> <span>ุฅุฏุงุฑุฉ ุงูุทูุงุจ</span></li>
                <li class="admin-only" onclick="navigate('classes')"><i class="fas fa-chalkboard"></i> <span>ุงููุตูู ุงูุฏุฑุงุณูุฉ</span></li>
                <li class="admin-only" onclick="navigate('grades')"><i class="fas fa-star"></i> <span>ุฑุตุฏ ุงูุฏุฑุฌุงุช</span></li>
                
                <li onclick="navigate('assignments')"><i class="fas fa-book-open"></i> <span>ุงููุงุฌุจุงุช ูุงูููุงู</span></li>
                <li onclick="navigate('leaves')"><i class="fas fa-notes-medical"></i> <span>ุงูุฅุฌุงุฒุงุช ุงููุฑุถูุฉ</span></li>
                
                <li class="student-only" onclick="navigate('my-grades')"><i class="fas fa-chart-line"></i> <span>ูุชุงุฆุฌู</span></li>
                
                <li onclick="logout()" class="logout-item"><i class="fas fa-sign-out-alt"></i> <span>ุชุณุฌูู ุฎุฑูุฌ</span></li>
            </ul>
        </aside>

        <main class="content-area">
            
            <header class="top-bar">
                <div class="page-title" id="page-title">ุงูุฑุฆูุณูุฉ</div>
                <div class="user-profile">
                    <span id="user-name">ุงููุฏูุฑ ุงูุนุงู</span>
                    <div class="avatar"><i class="fas fa-user"></i></div>
                </div>
            </header>

            <div id="view-dashboard" class="view-section active">
                <div class="stats-grid">
                    <div class="stat-card blue">
                        <div class="info">
                            <h3>ุงูุทูุงุจ</h3>
                            <p id="count-students">0</p>
                        </div>
                        <i class="fas fa-user-graduate"></i>
                    </div>
                    <div class="stat-card green">
                        <div class="info">
                            <h3>ุงููุนูููู</h3>
                            <p>12</p>
                        </div>
                        <i class="fas fa-chalkboard-teacher"></i>
                    </div>
                    <div class="stat-card orange">
                        <div class="info">
                            <h3>ุทูุจุงุช ุงูุฅุฌุงุฒุฉ</h3>
                            <p id="count-leaves">0</p>
                        </div>
                        <i class="fas fa-file-medical"></i>
                    </div>
                    <div class="stat-card purple">
                        <div class="info">
                            <h3>ุงููุงุฌุจุงุช ุงููุดุทุฉ</h3>
                            <p id="count-assignments">0</p>
                        </div>
                        <i class="fas fa-tasks"></i>
                    </div>
                </div>

                <div class="chart-container">
                    <h3>๐ ุฅุญุตุงุฆูุงุช ุงูุญุถูุฑ ููุฐุง ุงูุฃุณุจูุน</h3>
                    <div class="simple-chart">
                        <div class="bar" style="height: 80%;" title="ุงูุฃุญุฏ"><span>ุงูุฃุญุฏ</span></div>
                        <div class="bar" style="height: 95%;" title="ุงูุงุซููู"><span>ุงูุงุซููู</span></div>
                        <div class="bar" style="height: 60%;" title="ุงูุซูุงุซุงุก"><span>ุงูุซูุงุซุงุก</span></div>
                        <div class="bar" style="height: 85%;" title="ุงูุฃุฑุจุนุงุก"><span>ุงูุฃุฑุจุนุงุก</span></div>
                        <div class="bar" style="height: 70%;" title="ุงูุฎููุณ"><span>ุงูุฎููุณ</span></div>
                    </div>
                </div>
            </div>

            <div id="view-students" class="view-section">
                <div class="action-bar">
                    <button onclick="openModal('student-modal')" class="btn-action"><i class="fas fa-plus"></i> ุฅุถุงูุฉ ุทุงูุจ ุฌุฏูุฏ</button>
                    <input type="text" placeholder="ุจุญุซ ุนู ุทุงูุจ..." class="search-input">
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ุงุณู ุงูุทุงูุจ</th>
                                <th>ุฑูู ุงููููุฉ</th>
                                <th>ุงููุตู</th>
                                <th>ุงูุญุงูุฉ</th>
                                <th>ุฅุฌุฑุงุกุงุช</th>
                            </tr>
                        </thead>
                        <tbody id="students-table-body">
                            </tbody>
                    </table>
                </div>
            </div>

            <div id="view-grades" class="view-section">
                <div class="card-panel">
                    <h3>ุฑุตุฏ ุฏุฑุฌุงุช ุงูุทูุงุจ</h3>
                    <div class="form-row">
                        <select id="grade-student-select" class="input-std">
                            <option>ุงุฎุชุฑ ุงูุทุงูุจ...</option>
                        </select>
                        <select id="grade-subject" class="input-std">
                            <option value="ุฑูุงุถูุงุช">ุฑูุงุถูุงุช</option>
                            <option value="ููุฒูุงุก">ููุฒูุงุก</option>
                            <option value="ููููุงุก">ููููุงุก</option>
                            <option value="ูุบุฉ ุนุฑุจูุฉ">ูุบุฉ ุนุฑุจูุฉ</option>
                        </select>
                        <input type="number" id="grade-value" placeholder="ุงูุฏุฑุฌุฉ (ูู 100)" class="input-std">
                        <button onclick="saveGrade()" class="btn-action">ุฑุตุฏ ุงูุฏุฑุฌุฉ</button>
                    </div>
                </div>
                <div class="table-container">
                    <h4>ุขุฎุฑ ุงูุนูููุงุช</h4>
                    <table id="grades-history-table">
                        <thead><tr><th>ุงูุทุงูุจ</th><th>ุงููุงุฏุฉ</th><th>ุงูุฏุฑุฌุฉ</th></tr></thead>
                        <tbody></tbody>
                    </table>
                 </div>
            </div>

            <div id="view-leaves" class="view-section">
                <div class="student-only card-panel">
                    <h3><i class="fas fa-upload"></i> ุฑูุน ุชูุฑูุฑ ุทุจู ุฌุฏูุฏ</h3>
                    <div class="upload-area">
                        <input type="text" id="leave-name" placeholder="ุงูุงุณู ุงููุงูู" class="input-std">
                        <input type="text" id="leave-id" placeholder="ุฑูู ุงููููุฉ" class="input-std">
                        <input type="file" id="leave-file" accept="application/pdf" class="input-file">
                        <button onclick="uploadLeave()" class="btn-action">ุฅุฑุณุงู ูููุฏูุฑ</button>
                        <div id="upload-status"></div>
                    </div>
                </div>

                <div class="admin-only table-container">
                    <h3>ุงูุทูุจุงุช ุงููุงุฑุฏุฉ</h3>
                    <table id="leaves-admin-table">
                        <thead>
                            <tr>
                                <th>ุงูุทุงูุจ</th>
                                <th>ุงููููุฉ</th>
                                <th>ุงูุชุงุฑูุฎ</th>
                                <th>ุงูููู</th>
                                <th>ูุฑุงุฑ</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

             <div id="view-assignments" class="view-section">
                 <div class="admin-only card-panel">
                     <h3>ูุดุฑ ูุงุฌุจ ุฌุฏูุฏ</h3>
                     <textarea id="assign-content" placeholder="ุงูุชุจ ุชูุงุตูู ุงููุงุฌุจ..." rows="3" style="width:100%"></textarea>
                     <button onclick="postAssignment()" class="btn-action">ูุดุฑ ุงูุขู</button>
                 </div>
                 <div id="assignments-list" class="grid-cards">
                     </div>
             </div>

        </main>
    </section>

    <div id="student-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('student-modal')">&times;</span>
            <h2>ุชุณุฌูู ุทุงูุจ ุฌุฏูุฏ</h2>
            <input type="text" id="new-std-name" placeholder="ุงูุงุณู ุงูุซูุงุซู" class="input-std">
            <input type="text" id="new-std-id" placeholder="ุฑูู ุงููููุฉ" class="input-std">
            <select id="new-std-grade" class="input-std">
                <option value="ุฃูู ุซุงููู">ุฃูู ุซุงููู</option>
                <option value="ุซุงูู ุซุงููู">ุซุงูู ุซุงููู</option>
                <option value="ุซุงูุซ ุซุงููู">ุซุงูุซ ุซุงููู</option>
            </select>
            <button onclick="addNewStudent()" class="btn-action full">ุญูุธ</button>
        </div>
    </div>

    <script type="module" src="script.js"></script>
</body>
</html>
